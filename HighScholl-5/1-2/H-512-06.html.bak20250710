<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="utf-8">
	<title>스스로 해결하기-희망하는 진로 분야</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=0.5, maximum-scale=3, user-scalable=yes">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="format-detection" content="telephone=no">

	<script src= "https://tbacdn.kosac.re.kr/js/aidtScript.js"></script>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script src="./js/jquery-ui.min.js"></script>
	<script src="./js/swiper.js"></script>

	<script src="https://acv001.aiktbook.com/api/static/message-channel-iframe.js"></script>

	<!-- 브라우저 번역(다국어 관련) -->
	<link rel="stylesheet" href="./css/GoogleTranslate.css">
	<script type="text/javascript" src="./js/GoogleTranslate.js"></script>
	<script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=GoogleTranslateInitCallback"></script>

	<link rel="stylesheet" href="./css/jquery-ui.min.css">
	<link rel="stylesheet" href="./css/swiper.css">
	<link rel="stylesheet" href="./css/fonts.css">
	<link rel="stylesheet" href="./css/style.css">
	<link rel="stylesheet" href="./css/common_all.css">

<style>
	.diagram-chart__point.active i {
	border: 2px solid #000;
	border-radius: 50%;
}
</style>
</head>
<body>
	<div id="wrap">
		
		<main class="H_512_06_con">
			<div class="contents_con">
				<div class="title_con">
					<div class="contents_con">
						<div class="text_bg">
							<div class="text" tabindex="0">스스로 해결하기</div>
							<div class="bg"></div>
						</div>

						<div class="text_con">
							<h2 tabindex="0">
							디지털 사회와 직업 역량
							</h2>
							<h1 tabindex="0">
								희망하는 진로 분야 <b class="index">(1)</b>
							</h1>
						</div>
					</div>
				</div>

				<div class="contents_con">
					<form id="frm1"  autocomplete="off">
						<input type="hidden" name="aidt_pageTitle" value="스스로 해결하기:희망하는 진로 분야">
						<div class="slide_con">
							<div class="swiper-container H_512_06_slide" role="region" aria-label="희망하는 진로 분야">
								<div class="swiper-wrapper">
									<div class="swiper-slide H_512_06_slide_div_01" data-swiper-autoplay="4000" role="group" aria-label="">
										<div class="contents_con">
											<div class="title_con" tabindex="0">
												<span>
													<span class="num_text num01">1</span>디지털 기술이 내가 희망하는 진로 분야의 직업에 미칠 영향을 자유롭게 적어 보자.
												</span>
											</div>

											<div class="list_div">
												<ul>
													<li>
														<div class="list_div">
															<div class="title_con" tabindex="0">
																<span>
																	희망하는 진로 분야의 직업
																</span>
															</div>

															<div class="txt_con">
																<div class="q_con">
																	<div class="text01_con" tabindex="0">
																		<span>
																			예시
																		</span>
																	</div>

																	<div class="text02_con" tabindex="0">
																		<span>
																			간호사
																		</span>
																	</div>
																</div>

																<div class="a_con">
																	<input type="hidden" name="aidt_examId" value="1">
																	<input type="hidden" name="aidt_exam" value="희망하는 진로 분야의 직업을 적어보자.">
																	<input type="hidden" name="aidt_answer" value="">
																	<input type="hidden" name="aidt_mcqYn" value="N">
																	<input type="hidden" name="aidt_type" value="narrative">
																	<textarea name="aidt_input" placeholder="내용을 입력해 보자." class="textarea01"></textarea>
																</div>
															</div>
														</div>
													</li>
													<li>
														<div class="list_div">
															<div class="title_con" tabindex="0">
																<span>
																	디지털 기술이 미칠 영향
																</span>
															</div>

															<div class="txt_con">
																<div class="q_con">
																	<div class="text01_con" tabindex="0">
																		<span>
																			예시
																		</span>
																	</div>

																	<div class="text02_con" tabindex="0">
																		<span>
																			인공지능 기술이 적용된 안경으로 환자 주변의 위험 요소를 인식하고 알려 준다.
																		</span>
																	</div>
																</div>

																<div class="a_con">
																	<input type="hidden" name="aidt_examId" value="2">
																	<input type="hidden" name="aidt_exam" value="디지털 기술이 미칠 영향을 적어보자.">
																	<input type="hidden" name="aidt_answer" value="">
																	<input type="hidden" name="aidt_mcqYn" value="N">
																	<input type="hidden" name="aidt_type" value="narrative">
																	<textarea name="aidt_input" placeholder="내용을 입력해 보자." class="textarea02"></textarea>
																</div>
															</div>
														</div>
													</li>
												</ul>
											</div>
										</div>
									</div>
									<div class="swiper-slide H_512_06_slide_div_02" data-swiper-autoplay="4000" role="group" aria-label="">
										<div class="contents_con">
											<div class="title_con" tabindex="0">
												<span>
													<span class="num_text num02">2</span>내가 희망하는 직업에서 갖춰야 할 역량의 중요도를 그래프에 표시하고, 총점을 알아보자.
												</span>
											</div>
											
											<div class="diagram-chart">
												<div class="diagram-chart__image">
													<span class="diagram-chart_text ver1">창의적 사고</span>
													<span class="diagram-chart_text ver2">협력적 소통</span>
													<span class="diagram-chart_text ver3">지식 정보 처리</span>
													<span class="diagram-chart_text ver4">공동체 역량</span>
													<span class="diagram-chart_text ver5">컴퓨팅 사고</span>
													<img src="./img/h_512_line.svg" alt="여러 항목의 평가를 나타내는 레이더 차트입니다. 각 항목은 색상에 따라 평가된 값을 나타내며, 다음과 같은 항목들이 포함되어 있습니다: 창의적 사고, 지식 정보 처리, 컴퓨팅 사고, 공동체 역할, 협력적 소통. 각 항목은 평가 값에 따라 점이 위치하며, 차트의 각 축을 따라 점들이 배치되어 있습니다.">

													<!-- 5점 버튼 (빨강) -->
													<button type="button" class="diagram-chart__point diagram-chart__point--score5 type01" data-point="5" aria-label="5점 선택"><i class="graph-point red"></i></button>
													<button type="button" class="diagram-chart__point diagram-chart__point--score5 type02" data-point="5" aria-label="5점 선택"><i class="graph-point red"></i></button>
													<button type="button" class="diagram-chart__point diagram-chart__point--score5 type03" data-point="5" aria-label="5점 선택"><i class="graph-point red"></i></button>
													<button type="button" class="diagram-chart__point diagram-chart__point--score5 type04" data-point="5" aria-label="5점 선택"><i class="graph-point red"></i></button>
													<button type="button" class="diagram-chart__point diagram-chart__point--score5 type05" data-point="5" aria-label="5점 선택"><i class="graph-point red"></i></button>

													<!-- 4점 버튼 (오렌지) -->
													<button type="button" class="diagram-chart__point diagram-chart__point--score4 type01" data-point="4" aria-label="4점 선택"><i class="graph-point orange"></i></button>
													<button type="button" class="diagram-chart__point diagram-chart__point--score4 type02" data-point="4" aria-label="4점 선택"><i class="graph-point orange"></i></button>
													<button type="button" class="diagram-chart__point diagram-chart__point--score4 type03" data-point="4" aria-label="4점 선택"><i class="graph-point orange"></i></button>
													<button type="button" class="diagram-chart__point diagram-chart__point--score4 type04" data-point="4" aria-label="4점 선택"><i class="graph-point orange"></i></button>
													<button type="button" class="diagram-chart__point diagram-chart__point--score4 type05" data-point="4" aria-label="4점 선택"><i class="graph-point orange"></i></button>

													<!-- 3점 버튼 (파랑) -->
													<button type="button" class="diagram-chart__point diagram-chart__point--score3 type01" data-point="3" aria-label="3점 선택"><i class="graph-point blue"></i></button>
													<button type="button" class="diagram-chart__point diagram-chart__point--score3 type02" data-point="3" aria-label="3점 선택"><i class="graph-point blue"></i></button>
													<button type="button" class="diagram-chart__point diagram-chart__point--score3 type03" data-point="3" aria-label="3점 선택"><i class="graph-point blue"></i></button>
													<button type="button" class="diagram-chart__point diagram-chart__point--score3 type04" data-point="3" aria-label="3점 선택"><i class="graph-point blue"></i></button>
													<button type="button" class="diagram-chart__point diagram-chart__point--score3 type05" data-point="3" aria-label="3점 선택"><i class="graph-point blue"></i></button>

													<!-- 2점 버튼 (핑크) -->
													<button type="button" class="diagram-chart__point diagram-chart__point--score2 type01" data-point="2" aria-label="2점 선택"><i class="graph-point pink"></i></button>
													<button type="button" class="diagram-chart__point diagram-chart__point--score2 type02" data-point="2" aria-label="2점 선택"><i class="graph-point pink"></i></button>
													<button type="button" class="diagram-chart__point diagram-chart__point--score2 type03" data-point="2" aria-label="2점 선택"><i class="graph-point pink"></i></button>
													<button type="button" class="diagram-chart__point diagram-chart__point--score2 type04" data-point="2" aria-label="2점 선택"><i class="graph-point pink"></i></button>
													<button type="button" class="diagram-chart__point diagram-chart__point--score2 type05" data-point="2" aria-label="2점 선택"><i class="graph-point pink"></i></button>

													<!-- 1점 버튼 (녹색) -->
													<button type="button" class="diagram-chart__point diagram-chart__point--score1 type01" data-point="1" aria-label="1점 선택"><i class="graph-point green"></i></button>
													<button type="button" class="diagram-chart__point diagram-chart__point--score1 type02" data-point="1" aria-label="1점 선택"><i class="graph-point green"></i></button>
													<button type="button" class="diagram-chart__point diagram-chart__point--score1 type03" data-point="1" aria-label="1점 선택"><i class="graph-point green"></i></button>
													<button type="button" class="diagram-chart__point diagram-chart__point--score1 type04" data-point="1" aria-label="1점 선택"><i class="graph-point green"></i></button>
													<button type="button" class="diagram-chart__point diagram-chart__point--score1 type05" data-point="1" aria-label="1점 선택"><i class="graph-point green"></i></button>
												</div>

												<div class="diagram-chart__list--wrap">
													<div class="diagram-chart__list">
														<ul>
															<li>
																<div>
																	<i class="graph-point red"></i>
																	<i class="line"></i>
																</div>																
																<span>5점</span>
															</li>
															<li>
																<div>
																	<i class="graph-point orange"></i>
																	
																	<i class="line"></i>
																</div>	
																<span>4점</span>
															</li>
															<li>
																<div>
																	<i class="graph-point blue"></i>
																	
																	<i class="line"></i>
																</div>	
																<span>3점</span>
															</li>
															<li>
																<div>
																	<i class="graph-point pink"></i>
																	<i class="line"></i>
																</div>	
																<span>2점</span>
															</li>
															<li>
																<div>
																	<i class="graph-point green"></i>
																	<i class="line"></i>
																</div>																	
																<span>1점</span>
															</li>
														</ul>
													</div>
													<div class="diagram-chart__total">
													 <label>총점 <input type="text" name="aidt_input1"></label> 점
													</div>
												</div>
												
												<div class="btn_con btn_cont">
													<button id="a_btn_graph" class="a_btn a_btn01 a_btn_graph" type="button" aria-label="확인하기" tabindex="0">확인하기</button>
													<button id="a_btn_reset" class="a_btn a_btn02 a_btn_reset" type="button" aria-label="다시하기"  tabindex="0">다시 하기</button>
												</div>
											</div>
											
										</div>
									</div>
									<div class="swiper-slide H_512_06_slide_div_03" data-swiper-autoplay="4000" role="group" aria-label="">
										<div class="contents_con">
											<div class="title_con" tabindex="0">
												<span>
													<span class="num_text num03">3</span><span class="group"><span class="num_text num02">2</span>의 결과를 바탕으로 나에게 가장 필요한 역량이 무엇인지 생각해 보고,그 역량을 키우기 위한 실천 방안을 <br>적어 보자.</span>
												</span>
											</div>
											
											<div class="txt_con">
												<div class="q_con">
													<div class="text01_con" tabindex="0">
														<span>
															예시
														</span>
													</div>

													<div class="text02_con" tabindex="0">
														<span>
															협력적 소통 역량을 키우기 위해 모둠 활동을 할 때 친구의 의견을 존중하고 경청할 것이다.
														</span>
													</div>
												</div>

												<div class="a_con">
													<input type="hidden" name="aidt_examId" value="3">
													<input type="hidden" name="aidt_exam" value="나에게 가장 필요한 역량이 무엇인지 생각해 보고,그 역량을 키우기 위한 실천 방안을 적어 보자.">
													<input type="hidden" name="aidt_answer" value="">
													<input type="hidden" name="aidt_mcqYn" value="N">
													<input type="hidden" name="aidt_type" value="narrative">
													<textarea name="aidt_input" placeholder="내용을 입력해 보자." class="textarea03"></textarea>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>

							<div class="swiper-pagination H_512_06_slide_swiper-pagination"></div>

							<div class="slide_btn prev H_512_06_slide_prev_btn swiper-button-prev" aria-label="슬라이드 이전 버튼" tabindex="0"></div>
							<div class="slide_btn next H_512_06_slide_next_btn swiper-button-next" aria-label="슬라이드 다음 버튼" tabindex="0"></div>
						</div>
						
						<div class="btn_con">
							<button id="btn1" class="a_btn a_btn01" type="submit" aria-label="제출하기" tabindex="0">제출하기</button>
							<button id="btn1_1" class="a_btn a_btn02" type="submit" aria-label="다시 제출하기" style="display:none;" tabindex="0">다시 제출하기</button>
						</div>
						
						
					</form>
					<div class="popup_con_bg popup01"></div>
						<div class="popup_con popup01" role="alert"></div>

						<div class="popup_con_bg popup02"></div>
						<div class="popup_con popup02" role="alert"></div>
				</div>
			</div>
		</main>		
		
		
	</div>

<script>

			// H_512_06 슬라이드
			H_512_06_slide = new Swiper ('.H_512_06_slide', {
				slidesPerView: 'auto',
				effect : 'fade', 
				// autoHeight: true,
				fadeEffect: { 
					crossFade: true 
				},
				speed: 100,
				loop: false,
				pagination: {
					el: ".H_512_06_slide_swiper-pagination",
					clickable: true,
				},
				navigation: {
					nextEl: '.H_512_06_slide_next_btn',
					prevEl: '.H_512_06_slide_prev_btn',
				},
				observer: true,
				observeParents: true,
				simulateTouch: false,
				allowTouchMove: false,
			});
			
			// 제출하기 스크립트
			const child = new ClientAPI(); //본 코드는 데이터 전송 페이지마다 각각 별도로 들어있어야 하고, 내부 스크립트의 최상단에 위치해야함. 

			//제출 여부 받아서 버튼 제어
			child.receiveMessage((data)=>{
				if(data.submitYn === 'Y'){
					document.getElementById('btn1_1').style.display = "inline-block"; //수정하기 버튼 표시
					document.getElementById('btn1').style.display = "none"; //제출 버튼 숨기기
				}
			});

			// [제출하기]btn click 시 form#frm1 전송
			const btn1 = document.getElementById('btn1'); //제출 버튼
			btn1.addEventListener('click', () => {
				sendFormData()
			});

			// [수정하기]btn click 시 form#frm1 전송
			const btn1_1 = document.getElementById('btn1_1'); //수정 버튼 
			btn1_1.addEventListener('click', () => {
				sendFormData()
			});

			// 제출하기
			function sendFormData(){
				// 텍스트 영역이 모두 채워졌는지 확인
				const textarea1Filled = $(".textarea01").val() !== "";
				const textarea2Filled = $(".textarea02").val() !== "";
				const textarea3Filled = $(".textarea03").val() !== "";
				
				const input1Filled = $("input[type='text'][name='aidt_input1']").val() !== "";

				// 조건 확인 및 적절한 함수 호출
				if(!textarea1Filled || !textarea2Filled || !textarea3Filled) {
					btn_event01(); // 텍스트 영역이 하나라도 비어있는 경우
				} else {
					btn_event02(); // 모든 항목이 채워진 경우
				}
			}

			// 제출하기 - 내용 없음
			function btn_event01(){
				$(".H_512_06_con > .contents_con > .contents_con .btn_con .a_btn").blur();
				$(".H_512_06_con > .contents_con > .contents_con .popup_con_bg.popup01").fadeIn();
				$(".H_512_06_con > .contents_con > .contents_con .popup_con.popup01").fadeIn();

				setTimeout(function(){
					$(".H_512_06_con > .contents_con > .contents_con .popup_con_bg.popup01").fadeOut();
					$(".H_512_06_con > .contents_con > .contents_con .popup_con.popup01").fadeOut();
				}, 1000);
			}

			// 제출하기 - 내용 있음
			function btn_event02(){
				$(".H_512_06_con .btn_con .a_btn").blur();
				$(".H_512_06_con .popup_con_bg.popup02").fadeIn();
				$(".H_512_06_con .popup_con.popup02").fadeIn();

				// 버튼 전환
				 $("#btn1").hide();
				 $("#btn1_1").show();

				// 실제 데이터 전송
				child.sendFormData('frm1');

				setTimeout(function(){
					$(".H_512_06_con .popup_con_bg.popup02").fadeOut();
					$(".H_512_06_con .popup_con.popup02").fadeOut();
				}, 1000);
			}
			
			// H_512_06_slide_div_03 active 되었을때 버튼 나타나기
			function checkActiveSlide() {
				let btnCon = document.querySelector(".H_512_06_con > .contents_con > .contents_con .btn_con:not(.btn_cont)");
				let activeSlide = document.querySelector(".swiper-slide-active.H_512_06_slide_div_03");

				if (btnCon) {
					btnCon.style.display = activeSlide ? "block" : "none";
				}
			}

			const observer = new MutationObserver(checkActiveSlide);
			const targetNode = document.querySelector(".H_512_06_slide"); // 슬라이드 전체 감시

			if (targetNode) {
				observer.observe(targetNode, {
					childList: true,
					subtree: true,
					attributes: true,
					attributeFilter: ["class"]
				});
			}

			// 초기에 한 번 실행 (페이지 로드 후 바로 반영되도록)
			checkActiveSlide();

		</script>

<script>
	// 최상단에서 전역 변수로 선언
let selectedPoints = {
    type01: 0,
    type02: 0,
    type03: 0,
    type04: 0,
    type05: 0
};
let pointCoords = {};
$(document).ready(function () {

	// 점 클릭 처리
	$('.diagram-chart__point').on('click', function () {
		const $this = $(this);
		const point = parseInt($this.data('point'), 10);
		const classes = $this.attr('class').split(/\s+/);
		let type = classes.find(cls => cls.startsWith('type'));
		if (!type) return;

		$(`.diagram-chart__point.${type}`).removeClass('active');
		$this.addClass('active');
		selectedPoints[type] = point;

		const offset = $this.find('i').offset();
		const center = $('.diagram-chart__image').offset();
		const x = offset.left - center.left + 8;
		const y = offset.top - center.top + 8;
		pointCoords[type] = { x, y };

		let total = Object.values(selectedPoints).reduce((sum, val) => sum + val, 0);
		$('input[name="aidt_input1"]').val(total);
	});

	function drawLines() {
		$('#graph-line-svg').remove();
		if (Object.keys(pointCoords).length !== 5) return;

		const $container = $('.diagram-chart__image');
		const containerWidth = $container.width();
		const containerHeight = $container.height();

		const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
		svg.setAttribute("id", "graph-line-svg");
		svg.setAttribute("viewBox", `0 0 100 100`);
		svg.setAttribute("preserveAspectRatio", "xMidYMid meet");
		svg.setAttribute("style", "position:absolute; top:0; left:0; width:100%; height:100%; pointer-events:none;");

		const types = ["type01", "type02", "type03", "type04", "type05"];
		let pointsStr = "";

		types.forEach(type => {
			const coord = pointCoords[type];
			if (!coord) return;

			// 반응형 좌표: 0~100% 비율로 계산
			const xPercent = (coord.x / containerWidth) * 100;
			const yPercent = (coord.y / containerHeight) * 100;

			pointsStr += `${xPercent},${yPercent} `;
		});

		const polygon = document.createElementNS("http://www.w3.org/2000/svg", "polygon");
		polygon.setAttribute("points", pointsStr.trim());
		polygon.setAttribute("fill", "rgba(255, 0, 0, 0.3)");
		polygon.setAttribute("stroke", "red");
		polygon.setAttribute("stroke-width", "0.5");
		svg.appendChild(polygon);

		$container.append(svg);
	}

    // 다시하기 클릭 시 초기화
	$('#a_btn_reset').on('click', function () {
		$('.diagram-chart__point').removeClass('active');
		$('input[name="aidt_input1"]').val('');
		$('#graph-line-svg').remove();
		// === 이 부분이 중요! ===
		selectedPoints = {
			type01: 0,
			type02: 0,
			type03: 0,
			type04: 0,
			type05: 0
		};
		pointCoords = {};
	});
	// 확인하기 클릭 시 선 그리기
	$('#a_btn_graph').on('click', function (e) {
		const requiredTypes = ['type01', 'type02', 'type03', 'type04', 'type05'];
		let allSelected = requiredTypes.every(type => {
			return $(`.diagram-chart__point.${type}.active`).length > 0;
		});

		if (!allSelected) {
			e.preventDefault();
			$(".H_512_06_con .popup_con_bg.popup01").fadeIn();
			$(".H_512_06_con .popup_con.popup01").fadeIn();
			setTimeout(function () {
				$(".H_512_06_con .popup_con_bg.popup01").fadeOut();
				$(".H_512_06_con .popup_con.popup01").fadeOut();
			}, 1500);
			
			return false;
		}

		// 선 그리기 실행
		drawLines();
	});			

	// 다시하기 클릭 시 초기화
	$('#a_btn_reset').on('click', function () {
		$('.diagram-chart__point').removeClass('active');
		$('input[name="aidt_input1"]').val('');
		$('#graph-line-svg').remove();
		window.selectedPoints = {
			type01: 0,
			type02: 0,
			type03: 0,
			type04: 0,
			type05: 0
		};
		window.pointCoords = {};
	});
});
</script>


</body>
</html>
